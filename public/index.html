<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document Generation API Tester</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
    }
    .container {
      display: flex;
      gap: 20px;
    }
    .editor-container, .preview-container {
      flex: 1;
      border: 1px solid #ccc;
      border-radius: 5px;
      padding: 10px;
    }
    textarea {
      width: 100%;
      height: 400px;
      font-family: monospace;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      resize: vertical;
    }
    iframe {
      width: 100%;
      height: 400px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    .buttons {
      margin-top: 20px;
      text-align: center;
    }
    button {
      padding: 10px 20px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      margin: 0 10px;
    }
    button:hover {
      background-color: #45a049;
    }
    .pdf-button {
      background-color: #f44336;
    }
    .pdf-button:hover {
      background-color: #d32f2f;
    }
    .doc-button {
      background-color: #2196F3;
    }
    .doc-button:hover {
      background-color: #0b7dda;
    }
    .excel-button {
      background-color: #4CAF50;
    }
    .excel-button:hover {
      background-color: #45a049;
    }
    .ppt-button {
      background-color: #FF9800;
    }
    .ppt-button:hover {
      background-color: #F57C00;
    }
    .md-button {
      background-color: #9C27B0;
    }
    .md-button:hover {
      background-color: #7B1FA2;
    }
    .status {
      margin-top: 20px;
      padding: 10px;
      border-radius: 4px;
      text-align: center;
    }
    .success {
      background-color: #d4edda;
      color: #155724;
    }
    .error {
      background-color: #f8d7da;
      color: #721c24;
    }
    .tabs {
      display: flex;
      margin-bottom: 20px;
    }
    .tab {
      padding: 10px 20px;
      cursor: pointer;
      background-color: #f1f1f1;
      border: 1px solid #ccc;
      border-bottom: none;
      border-radius: 4px 4px 0 0;
      margin-right: 5px;
    }
    .tab.active {
      background-color: #fff;
      border-bottom: 1px solid #fff;
    }
    .preview-html {
      padding: 20px;
      overflow: auto;
    }
  </style>
</head>
<body>
  <h1>Document Generation API Tester</h1>
  
  <div class="tabs">
    <div class="tab active" data-tab="html-editor">HTML Editor</div>
    <div class="tab" data-tab="markdown-editor">Markdown Editor</div>
    <div class="tab" data-tab="table-editor">Table Editor</div>
    <div class="tab" data-tab="slides-editor">Slides Editor</div>
    <div class="tab" data-tab="about">About</div>
  </div>
  
  <div id="html-editor" class="tab-content">
    <div class="container">
      <div class="editor-container">
        <h2>HTML Editor</h2>
        <textarea id="htmlEditor"><!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Test Document</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
    }
    h1 {
      color: #333;
      border-bottom: 1px solid #ccc;
      padding-bottom: 10px;
    }
    p {
      line-height: 1.6;
    }
  </style>
</head>
<body>
  <h1>Document Generation Test</h1>
  <p>This is a test document to verify that the document generation API is working correctly.</p>
  <p>The API should convert this HTML content into the requested format.</p>
  <p>Current date and time: <script>document.write(new Date().toLocaleString())</script></p>
</body>
</html></textarea>
      </div>
      
      <div class="preview-container">
        <h2>Preview</h2>
        <iframe id="htmlPreview"></iframe>
      </div>
    </div>
    
    <div class="buttons">
      <button id="updateHtmlPreview">Update Preview</button>
      <button id="generatePdf" class="pdf-button">Generate PDF</button>
      <button id="generateDoc" class="doc-button">Generate Word Doc</button>
      <button id="convertToMarkdown" class="md-button">Convert to Markdown</button>
    </div>
    
    <div id="htmlStatus" class="status" style="display: none;"></div>
  </div>
  
  <div id="markdown-editor" class="tab-content" style="display: none;">
    <div class="container">
      <div class="editor-container">
        <h2>Markdown Editor</h2>
        <textarea id="markdownEditor"># Markdown Test

This is a **bold text** and this is *italic text*.

## Lists

### Unordered List
- Item 1
- Item 2
- Item 3

### Ordered List
1. First item
2. Second item
3. Third item

## Code

Inline `code` example.

```javascript
// Code block
function hello() {
  console.log("Hello, world!");
}
```

## Table

| Header 1 | Header 2 |
| -------- | -------- |
| Cell 1   | Cell 2   |
| Cell 3   | Cell 4   |

## Link and Image

[Example Link](https://example.com)

Current date and time: </textarea>
      </div>
      
      <div class="preview-container">
        <h2>Preview</h2>
        <div id="markdownPreview" class="preview-html"></div>
      </div>
    </div>
    
    <div class="buttons">
      <button id="updateMarkdownPreview">Update Preview</button>
      <button id="convertToHtml" class="md-button">Convert to HTML</button>
      <button id="generateMarkdownPdf" class="pdf-button">Generate PDF</button>
      <button id="generateMarkdownDoc" class="doc-button">Generate Word Doc</button>
    </div>
    
    <div id="markdownStatus" class="status" style="display: none;"></div>
  </div>
  
  <div id="table-editor" class="tab-content" style="display: none;">
    <div class="container">
      <div class="editor-container">
        <h2>HTML Table Editor</h2>
        <textarea id="tableEditor"><!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Excel Test</title>
  <style>
    table {
      border-collapse: collapse;
      width: 100%;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #f2f2f2;
    }
    tr:nth-child(even) {
      background-color: #f9f9f9;
    }
  </style>
</head>
<body>
  <h1>Excel Generation Test</h1>
  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Email</th>
        <th>Date</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>1</td>
        <td>John Doe</td>
        <td>john@example.com</td>
        <td>2025-04-18</td>
      </tr>
      <tr>
        <td>2</td>
        <td>Jane Smith</td>
        <td>jane@example.com</td>
        <td>2025-04-18</td>
      </tr>
      <tr>
        <td>3</td>
        <td>Bob Johnson</td>
        <td>bob@example.com</td>
        <td>2025-04-18</td>
      </tr>
    </tbody>
  </table>
</body>
</html></textarea>
      </div>
      
      <div class="preview-container">
        <h2>Preview</h2>
        <iframe id="tablePreview"></iframe>
      </div>
    </div>
    
    <div class="buttons">
      <button id="updateTablePreview">Update Preview</button>
      <button id="generateExcel" class="excel-button">Generate Excel</button>
      <button id="generateTablePdf" class="pdf-button">Generate PDF</button>
      <button id="generateTableDoc" class="doc-button">Generate Word Doc</button>
      <button id="convertTableToMarkdown" class="md-button">Convert to Markdown</button>
    </div>
    
    <div id="tableStatus" class="status" style="display: none;"></div>
  </div>
  
  <div id="slides-editor" class="tab-content" style="display: none;">
    <div class="container">
      <div class="editor-container">
        <h2>HTML Slides Editor</h2>
        <textarea id="slidesEditor"><!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>PowerPoint Test</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
    }
    h1, h2, h3 {
      color: #333;
      margin-top: 30px;
    }
    p {
      line-height: 1.6;
    }
    ul {
      margin-left: 20px;
    }
  </style>
</head>
<body>
  <h1>PowerPoint Generation Test</h1>
  <p>This is the introduction slide content.</p>
  
  <h2>Second Slide</h2>
  <p>This is the content for the second slide.</p>
  <p>It has multiple paragraphs of information.</p>
  
  <h2>Third Slide</h2>
  <p>This is the content for the third slide.</p>
  <ul>
    <li>Bullet point 1</li>
    <li>Bullet point 2</li>
    <li>Bullet point 3</li>
  </ul>
  
  <h2>Conclusion</h2>
  <p>This is the final slide with a conclusion.</p>
  <p>Thank you for your attention!</p>
</body>
</html></textarea>
      </div>
      
      <div class="preview-container">
        <h2>Preview</h2>
        <iframe id="slidesPreview"></iframe>
      </div>
    </div>
    
    <div class="buttons">
      <button id="updateSlidesPreview">Update Preview</button>
      <button id="generatePpt" class="ppt-button">Generate PowerPoint</button>
      <button id="generateSlidesPdf" class="pdf-button">Generate PDF</button>
      <button id="generateSlidesDoc" class="doc-button">Generate Word Doc</button>
      <button id="convertSlidesToMarkdown" class="md-button">Convert to Markdown</button>
    </div>
    
    <div id="slidesStatus" class="status" style="display: none;"></div>
  </div>
  
  <div id="about" class="tab-content" style="display: none;">
    <h2>About the Document Generation API</h2>
    <p>This API provides endpoints to convert content into different document formats:</p>
    
    <h3>HTML to PDF</h3>
    <p>Endpoint: <code>/api/1/html-to-pdf</code></p>
    <p>Converts HTML to PDF using Puppeteer, which provides high-quality PDF rendering with full CSS support.</p>
    
    <h3>HTML to Word Document</h3>
    <p>Endpoint: <code>/api/1/html-to-doc</code></p>
    <p>Converts HTML to a Microsoft Word document (.doc) format.</p>
    
    <h3>HTML to Excel Spreadsheet</h3>
    <p>Endpoint: <code>/api/1/html-to-excel</code></p>
    <p>Converts HTML tables to Excel spreadsheets (.xlsx) format. Each table in the HTML becomes a separate worksheet.</p>
    
    <h3>HTML to PowerPoint</h3>
    <p>Endpoint: <code>/api/1/html-to-ppt</code></p>
    <p>Converts HTML with headings to PowerPoint presentations (.pptx) format. Each heading becomes a new slide.</p>
    
    <h3>HTML to Markdown</h3>
    <p>Endpoint: <code>/api/1/html-to-markdown</code></p>
    <p>Converts HTML to Markdown format, which is a lightweight markup language with plain text formatting syntax.</p>
    
    <h3>Markdown to HTML</h3>
    <p>Endpoint: <code>/api/1/markdown-to-html</code></p>
    <p>Converts Markdown to HTML using the marked library.</p>
  </div>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // HTML Editor elements
      const htmlEditor = document.getElementById('htmlEditor');
      const htmlPreview = document.getElementById('htmlPreview');
      const updateHtmlPreviewBtn = document.getElementById('updateHtmlPreview');
      const generatePdfBtn = document.getElementById('generatePdf');
      const generateDocBtn = document.getElementById('generateDoc');
      const convertToMarkdownBtn = document.getElementById('convertToMarkdown');
      const htmlStatus = document.getElementById('htmlStatus');
      
      // Markdown Editor elements
      const markdownEditor = document.getElementById('markdownEditor');
      const markdownPreview = document.getElementById('markdownPreview');
      const updateMarkdownPreviewBtn = document.getElementById('updateMarkdownPreview');
      const convertToHtmlBtn = document.getElementById('convertToHtml');
      const generateMarkdownPdfBtn = document.getElementById('generateMarkdownPdf');
      const generateMarkdownDocBtn = document.getElementById('generateMarkdownDoc');
      const markdownStatus = document.getElementById('markdownStatus');
      
      // Table Editor elements
      const tableEditor = document.getElementById('tableEditor');
      const tablePreview = document.getElementById('tablePreview');
      const updateTablePreviewBtn = document.getElementById('updateTablePreview');
      const generateExcelBtn = document.getElementById('generateExcel');
      const generateTablePdfBtn = document.getElementById('generateTablePdf');
      const generateTableDocBtn = document.getElementById('generateTableDoc');
      const convertTableToMarkdownBtn = document.getElementById('convertTableToMarkdown');
      const tableStatus = document.getElementById('tableStatus');
      
      // Slides Editor elements
      const slidesEditor = document.getElementById('slidesEditor');
      const slidesPreview = document.getElementById('slidesPreview');
      const updateSlidesPreviewBtn = document.getElementById('updateSlidesPreview');
      const generatePptBtn = document.getElementById('generatePpt');
      const generateSlidesPdfBtn = document.getElementById('generateSlidesPdf');
      const generateSlidesDocBtn = document.getElementById('generateSlidesDoc');
      const convertSlidesToMarkdownBtn = document.getElementById('convertSlidesToMarkdown');
      const slidesStatus = document.getElementById('slidesStatus');
      
      // Tab elements
      const tabs = document.querySelectorAll('.tab');
      const tabContents = document.querySelectorAll('.tab-content');
      
      // Add current date to markdown editor
      markdownEditor.value += new Date().toLocaleString();
      
      // Tab functionality
      tabs.forEach(tab => {
        tab.addEventListener('click', () => {
          const tabId = tab.getAttribute('data-tab');
          
          // Update active tab
          tabs.forEach(t => t.classList.remove('active'));
          tab.classList.add('active');
          
          // Show selected tab content
          tabContents.forEach(content => {
            content.style.display = content.id === tabId ? 'block' : 'none';
          });
        });
      });
      
      // HTML Editor functionality
      updateHtmlPreviewBtn.addEventListener('click', updateHtmlPreview);
      generatePdfBtn.addEventListener('click', () => generateDocument('pdf', htmlEditor.value, htmlStatus));
      generateDocBtn.addEventListener('click', () => generateDocument('doc', htmlEditor.value, htmlStatus));
      convertToMarkdownBtn.addEventListener('click', () => convertHtmlToMarkdown(htmlEditor.value, htmlStatus));
      
      // Markdown Editor functionality
      updateMarkdownPreviewBtn.addEventListener('click', updateMarkdownPreview);
      convertToHtmlBtn.addEventListener('click', convertMarkdownToHtml);
      generateMarkdownPdfBtn.addEventListener('click', generateMarkdownPdf);
      generateMarkdownDocBtn.addEventListener('click', generateMarkdownDoc);
      
      // Table Editor functionality
      updateTablePreviewBtn.addEventListener('click', updateTablePreview);
      generateExcelBtn.addEventListener('click', generateExcel);
      generateTablePdfBtn.addEventListener('click', () => generateDocument('pdf', tableEditor.value, tableStatus));
      generateTableDocBtn.addEventListener('click', () => generateDocument('doc', tableEditor.value, tableStatus));
      convertTableToMarkdownBtn.addEventListener('click', () => convertHtmlToMarkdown(tableEditor.value, tableStatus));
      
      // Slides Editor functionality
      updateSlidesPreviewBtn.addEventListener('click', updateSlidesPreview);
      generatePptBtn.addEventListener('click', generatePpt);
      generateSlidesPdfBtn.addEventListener('click', () => generateDocument('pdf', slidesEditor.value, slidesStatus));
      generateSlidesDocBtn.addEventListener('click', () => generateDocument('doc', slidesEditor.value, slidesStatus));
      convertSlidesToMarkdownBtn.addEventListener('click', () => convertHtmlToMarkdown(slidesEditor.value, slidesStatus));
      
      // Update HTML preview on load
      updateHtmlPreview();
      
      // Update Markdown preview on load
      updateMarkdownPreview();
      
      // Update Table preview on load
      updateTablePreview();
      
      // Update Slides preview on load
      updateSlidesPreview();
      
      function updateHtmlPreview() {
        const html = htmlEditor.value;
        const blob = new Blob([html], { type: 'text/html' });
        htmlPreview.src = URL.createObjectURL(blob);
      }
      
      function updateTablePreview() {
        const html = tableEditor.value;
        const blob = new Blob([html], { type: 'text/html' });
        tablePreview.src = URL.createObjectURL(blob);
      }
      
      function updateSlidesPreview() {
        const html = slidesEditor.value;
        const blob = new Blob([html], { type: 'text/html' });
        slidesPreview.src = URL.createObjectURL(blob);
      }
      
      async function updateMarkdownPreview() {
        try {
          const markdown = markdownEditor.value;
          
          // Convert markdown to HTML
          const response = await fetch('/api/1/markdown-to-html', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ markdown }),
          });
          
          if (!response.ok) {
            const errorData = await response.json();
            throw new Error(errorData.error || response.statusText);
          }
          
          const result = await response.json();
          markdownPreview.innerHTML = result.html;
          
        } catch (error) {
          console.error('Error updating markdown preview:', error);
          markdownStatus.className = 'status error';
          markdownStatus.textContent = `Error: ${error.message}`;
          markdownStatus.style.display = 'block';
        }
      }
      
      async function convertHtmlToMarkdown(html, statusElement) {
        try {
          statusElement.className = 'status';
          statusElement.textContent = 'Converting HTML to Markdown...';
          statusElement.style.display = 'block';
          
          const response = await fetch('/api/1/html-to-markdown', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ html }),
          });
          
          if (!response.ok) {
            const errorData = await response.json();
            throw new Error(errorData.error || response.statusText);
          }
          
          const result = await response.json();
          
          // Create a download link for the Markdown
          const blob = new Blob([result.markdown], { type: 'text/markdown' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = 'document.md';
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
          
          statusElement.className = 'status success';
          statusElement.textContent = 'Markdown generated successfully!';
        } catch (error) {
          console.error('Error converting HTML to Markdown:', error);
          statusElement.className = 'status error';
          statusElement.textContent = `Error: ${error.message}`;
        }
      }
      
      async function convertMarkdownToHtml() {
        try {
          const markdown = markdownEditor.value;
          
          markdownStatus.className = 'status';
          markdownStatus.textContent = 'Converting Markdown to HTML...';
          markdownStatus.style.display = 'block';
          
          // Convert markdown to HTML
          const response = await fetch('/api/1/markdown-to-html', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ markdown }),
          });
          
          if (!response.ok) {
            const errorData = await response.json();
            throw new Error(errorData.error || response.statusText);
          }
          
          const result = await response.json();
          
          // Create a download link for the HTML
          const blob = new Blob([result.html], { type: 'text/html' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = 'document.html';
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
          
          markdownStatus.className = 'status success';
          markdownStatus.textContent = 'HTML generated successfully!';
        } catch (error) {
          console.error('Error converting markdown to HTML:', error);
          markdownStatus.className = 'status error';
          markdownStatus.textContent = `Error: ${error.message}`;
        }
      }
      
      async function generateMarkdownPdf() {
        try {
          const markdown = markdownEditor.value;
          
          markdownStatus.className = 'status';
          markdownStatus.textContent = 'Converting Markdown to PDF...';
          markdownStatus.style.display = 'block';
          
          // First convert markdown to HTML
          const mdResponse = await fetch('/api/1/markdown-to-html', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ markdown }),
          });
          
          if (!mdResponse.ok) {
            const errorData = await mdResponse.json();
            throw new Error(errorData.error || mdResponse.statusText);
          }
          
          const { html } = await mdResponse.json();
          
          // Then generate PDF from the HTML
          const pdfResponse = await fetch('/api/1/html-to-pdf', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ html }),
          });
          
          if (!pdfResponse.ok) {
            const errorData = await pdfResponse.json();
            throw new Error(errorData.error || pdfResponse.statusText);
          }
          
          const pdfBlob = await pdfResponse.blob();
          const url = URL.createObjectURL(pdfBlob);
          const a = document.createElement('a');
          a.href = url;
          a.download = 'document.pdf';
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
          
          markdownStatus.className = 'status success';
          markdownStatus.textContent = 'PDF generated successfully!';
        } catch (error) {
          console.error('Error generating PDF from markdown:', error);
          markdownStatus.className = 'status error';
          markdownStatus.textContent = `Error: ${error.message}`;
        }
      }
      
      async function generateMarkdownDoc() {
        try {
          const markdown = markdownEditor.value;
          
          markdownStatus.className = 'status';
          markdownStatus.textContent = 'Converting Markdown to Word document...';
          markdownStatus.style.display = 'block';
          
          // First convert markdown to HTML
          const mdResponse = await fetch('/api/1/markdown-to-html', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ markdown }),
          });
          
          if (!mdResponse.ok) {
            const errorData = await mdResponse.json();
            throw new Error(errorData.error || mdResponse.statusText);
          }
          
          const { html } = await mdResponse.json();
          
          // Then generate DOC from the HTML
          const docResponse = await fetch('/api/1/html-to-doc', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ 
              html,
              filename: 'document.doc'
            }),
          });
          
          if (!docResponse.ok) {
            const errorData = await docResponse.json();
            throw new Error(errorData.error || docResponse.statusText);
          }
          
          const docBlob = await docResponse.blob();
          const url = URL.createObjectURL(docBlob);
          const a = document.createElement('a');
          a.href = url;
          a.download = 'document.doc';
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
          
          markdownStatus.className = 'status success';
          markdownStatus.textContent = 'Word document generated successfully!';
        } catch (error) {
          console.error('Error generating Word document from markdown:', error);
          markdownStatus.className = 'status error';
          markdownStatus.textContent = `Error: ${error.message}`;
        }
      }
      
      async function generateExcel() {
        try {
          const html = tableEditor.value;
          
          tableStatus.className = 'status';
          tableStatus.textContent = 'Generating Excel spreadsheet...';
          tableStatus.style.display = 'block';
          
          const response = await fetch('/api/1/html-to-excel', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ 
              html,
              filename: 'data.xlsx',
              sheetName: 'Data'
            }),
          });
          
          if (!response.ok) {
            const errorData = await response.json();
            throw new Error(errorData.error || response.statusText);
          }
          
          const excelBlob = await response.blob();
          const url = URL.createObjectURL(excelBlob);
          const a = document.createElement('a');
          a.href = url;
          a.download = 'data.xlsx';
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
          
          tableStatus.className = 'status success';
          tableStatus.textContent = 'Excel spreadsheet generated successfully!';
        } catch (error) {
          console.error('Error generating Excel spreadsheet:', error);
          tableStatus.className = 'status error';
          tableStatus.textContent = `Error: ${error.message}`;
        }
      }
      
      async function generatePpt() {
        try {
          const html = slidesEditor.value;
          
          slidesStatus.className = 'status';
          slidesStatus.textContent = 'Generating PowerPoint presentation...';
          slidesStatus.style.display = 'block';
          
          const response = await fetch('/api/1/html-to-ppt', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ 
              html,
              filename: 'presentation.pptx',
              title: 'Presentation'
            }),
          });
          
          if (!response.ok) {
            const errorData = await response.json();
            throw new Error(errorData.error || response.statusText);
          }
          
          const pptBlob = await response.blob();
          const url = URL.createObjectURL(pptBlob);
          const a = document.createElement('a');
          a.href = url;
          a.download = 'presentation.pptx';
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
          
          slidesStatus.className = 'status success';
